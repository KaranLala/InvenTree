{"version":3,"file":"SalesIndex-D6TH0MII.js","sources":["../../../../../../frontend/src/pages/sales/SalesIndex.tsx"],"sourcesContent":["import { t } from '@lingui/core/macro';\nimport { Stack } from '@mantine/core';\nimport {\n  IconBuildingStore,\n  IconCalendar,\n  IconTable,\n  IconTruckDelivery,\n  IconTruckReturn\n} from '@tabler/icons-react';\nimport { useMemo } from 'react';\n\nimport { ModelType } from '@lib/enums/ModelType';\nimport { UserRoles } from '@lib/enums/Roles';\nimport { useLocalStorage } from '@mantine/hooks';\nimport SegmentedIconControl from '../../components/buttons/SegmentedIconControl';\nimport OrderCalendar from '../../components/calendar/OrderCalendar';\nimport PermissionDenied from '../../components/errors/PermissionDenied';\nimport { PageDetail } from '../../components/nav/PageDetail';\nimport { PanelGroup } from '../../components/panels/PanelGroup';\nimport { useUserState } from '../../states/UserState';\nimport { CompanyTable } from '../../tables/company/CompanyTable';\nimport { ReturnOrderTable } from '../../tables/sales/ReturnOrderTable';\nimport { SalesOrderTable } from '../../tables/sales/SalesOrderTable';\n\nfunction SalesOrderOverview({\n  view\n}: {\n  view: string;\n}) {\n  switch (view) {\n    case 'calendar':\n      return (\n        <OrderCalendar\n          model={ModelType.salesorder}\n          role={UserRoles.sales_order}\n          params={{ outstanding: true }}\n        />\n      );\n    case 'table':\n    default:\n      return <SalesOrderTable />;\n  }\n}\n\nfunction ReturnOrderOverview({\n  view\n}: {\n  view: string;\n}) {\n  switch (view) {\n    case 'calendar':\n      return (\n        <OrderCalendar\n          model={ModelType.returnorder}\n          role={UserRoles.return_order}\n          params={{ outstanding: true }}\n        />\n      );\n    case 'table':\n    default:\n      return <ReturnOrderTable />;\n  }\n}\n\nexport default function SalesIndex() {\n  const user = useUserState();\n\n  const [salesOrderView, setSalesOrderView] = useLocalStorage<string>({\n    key: 'salesOrderView',\n    defaultValue: 'table'\n  });\n\n  const [returnOrderView, setReturnOrderView] = useLocalStorage<string>({\n    key: 'returnOrderView',\n    defaultValue: 'table'\n  });\n\n  const panels = useMemo(() => {\n    return [\n      {\n        name: 'salesorders',\n        label: t`Sales Orders`,\n        icon: <IconTruckDelivery />,\n        content: <SalesOrderOverview view={salesOrderView} />,\n        controls: (\n          <SegmentedIconControl\n            value={salesOrderView}\n            onChange={setSalesOrderView}\n            data={[\n              { value: 'table', label: t`Table View`, icon: <IconTable /> },\n              {\n                value: 'calendar',\n                label: t`Calendar View`,\n                icon: <IconCalendar />\n              }\n            ]}\n          />\n        ),\n        hidden: !user.hasViewRole(UserRoles.sales_order)\n      },\n      {\n        name: 'returnorders',\n        label: t`Return Orders`,\n        icon: <IconTruckReturn />,\n        content: <ReturnOrderOverview view={returnOrderView} />,\n        controls: (\n          <SegmentedIconControl\n            value={returnOrderView}\n            onChange={setReturnOrderView}\n            data={[\n              { value: 'table', label: t`Table View`, icon: <IconTable /> },\n              {\n                value: 'calendar',\n                label: t`Calendar View`,\n                icon: <IconCalendar />\n              }\n            ]}\n          />\n        ),\n        hidden: !user.hasViewRole(UserRoles.return_order)\n      },\n      {\n        name: 'customers',\n        label: t`Customers`,\n        icon: <IconBuildingStore />,\n        content: (\n          <CompanyTable path='sales/customer' params={{ is_customer: true }} />\n        )\n      }\n    ];\n  }, [user, salesOrderView, returnOrderView]);\n\n  if (!user.isLoggedIn() || !user.hasViewRole(UserRoles.sales_order)) {\n    return <PermissionDenied />;\n  }\n\n  return (\n    <Stack>\n      <PageDetail title={t`Sales`} />\n      <PanelGroup\n        pageKey='sales-index'\n        panels={panels}\n        model={'sales'}\n        id={null}\n      />\n    </Stack>\n  );\n}\n"],"names":["SalesOrderOverview","view","jsx","OrderCalendar","ModelType","salesorder","UserRoles","sales_order","outstanding","SalesOrderTable","ReturnOrderOverview","returnorder","return_order","ReturnOrderTable","SalesIndex","user","useUserState","salesOrderView","setSalesOrderView","useLocalStorage","key","defaultValue","returnOrderView","setReturnOrderView","panels","useMemo","name","label","_i18n","_","id","icon","IconTruckDelivery","content","controls","SegmentedIconControl","value","IconTable","IconCalendar","hidden","hasViewRole","IconTruckReturn","IconBuildingStore","CompanyTable","is_customer","isLoggedIn","PermissionDenied","Stack","PageDetail","PanelGroup"],"mappings":"+lCAwBA,SAASA,EAAmB,CAC1BC,KAAAA,CAGF,EAAG,CACD,OAAQA,EAAI,CACV,IAAK,WAED,OAAAC,EAAA,IAACC,GACC,MAAOC,EAAUC,WACjB,KAAMC,EAAUC,YAChB,OAAQ,CAAEC,YAAa,EAAA,EACvB,EAEN,IAAK,QACL,QACE,aAAQC,EAAkB,EAAA,CAAA,CAEhC,CAEA,SAASC,EAAoB,CAC3BT,KAAAA,CAGF,EAAG,CACD,OAAQA,EAAI,CACV,IAAK,WAED,OAAAC,EAAA,IAACC,GACC,MAAOC,EAAUO,YACjB,KAAML,EAAUM,aAChB,OAAQ,CAAEJ,YAAa,EAAA,EACvB,EAEN,IAAK,QACL,QACE,aAAQK,EAAmB,EAAA,CAAA,CAEjC,CAEA,SAAwBC,IAAa,CACnC,MAAMC,EAAOC,EAAa,EAEpB,CAACC,EAAgBC,CAAiB,EAAIC,EAAwB,CAClEC,IAAK,iBACLC,aAAc,OAAA,CACf,EAEK,CAACC,EAAiBC,CAAkB,EAAIJ,EAAwB,CACpEC,IAAK,kBACLC,aAAc,OAAA,CACf,EAEKG,EAASC,EAAAA,QAAQ,IACd,CACL,CACEC,KAAM,cACNC,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAAe,EACtBC,WAAOC,EAAoB,EAAA,EAC3BC,QAAS/B,EAAAA,IAACF,EAAmB,CAAA,KAAMiB,CAAkB,CAAA,EACrDiB,eACGC,EACC,CAAA,MAAOlB,EACP,SAAUC,EACV,KAAM,CACJ,CAAEkB,MAAO,QAAST,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAAa,EAAEC,WAAOM,EAAS,CAAA,CAAA,CAAA,EACxD,CACED,MAAO,WACPT,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAAgB,EACvBC,WAAOO,EAAY,CAAA,CAAA,CACpB,CAAA,EAGN,EACDC,OAAQ,CAACxB,EAAKyB,YAAYlC,EAAUC,WAAW,CAAA,EAEjD,CACEmB,KAAM,eACNC,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAAgB,EACvBC,WAAOU,EAAkB,EAAA,EACzBR,QAAS/B,EAAAA,IAACQ,EAAoB,CAAA,KAAMY,CAAmB,CAAA,EACvDY,eACGC,EACC,CAAA,MAAOb,EACP,SAAUC,EACV,KAAM,CACJ,CAAEa,MAAO,QAAST,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAAa,EAAEC,WAAOM,EAAS,CAAA,CAAA,CAAA,EACxD,CACED,MAAO,WACPT,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAAgB,EACvBC,WAAOO,EAAY,CAAA,CAAA,CACpB,CAAA,EAGN,EACDC,OAAQ,CAACxB,EAAKyB,YAAYlC,EAAUM,YAAY,CAAA,EAElD,CACEc,KAAM,YACNC,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAAY,EACnBC,WAAOW,EAAoB,EAAA,EAC3BT,QACE/B,EAAA,IAACyC,EAAa,CAAA,KAAK,iBAAiB,OAAQ,CAAEC,YAAa,EAAA,CAAO,CAAA,CAAA,CAErE,EAEF,CAAC7B,EAAME,EAAgBK,CAAe,CAAC,EAEtC,MAAA,CAACP,EAAK8B,cAAgB,CAAC9B,EAAKyB,YAAYlC,EAAUC,WAAW,QACvDuC,EAAmB,EAAA,SAI1BC,EACC,CAAA,SAAA,CAAC7C,EAAAA,IAAA8C,EAAA,CAAW,MAAMpB,EAAAC,EAAC,CAAAC,GAAA,QAAA,CAAO,EAAE,EAC5B5B,MAAC+C,GACC,QAAQ,cACR,OAAAzB,EACA,MAAO,QACP,GAAI,IAAK,CAAA,CAAA,EAEb,CAEJ"}
