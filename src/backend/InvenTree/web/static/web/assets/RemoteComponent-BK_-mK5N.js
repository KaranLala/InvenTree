import{r as e,i as x,j as s,S as h,bU as R,B as j,d as g,y as v,M as E}from"./vendor-c9tu_e1b.js";import{u as y,a as C,q as _,C as S}from"./index-C-YqHYR0.js";import{A as w}from"./DesktopAppView-Bg1vO8uy.js";import{L as $,k as H}from"./ThemeContext-CVPHi9Q7.js";import{f as b}from"./PluginSource-CpS38oS9.js";var L=(r=>(r.dashboard="dashboard",r.panel="panel",r.template_editor="template_editor",r.template_preview="template_preview",r.navigation="navigation",r))(L||{});const M=(r,d)=>e.forwardRef((a,c)=>{const i=e.useRef(),[f,u]=e.useState(void 0),n=e.useRef(),l=e.useRef(),o=e.useRef();return e.useImperativeHandle(c,()=>({setCode:t=>{l.current?l.current(t):n.current=t},getCode:()=>{var t;return(t=o.current)==null?void 0:t.call(o)}})),e.useEffect(()=>{let t;return(async()=>{try{t=await r({ref:i.current,registerHandlers:({getCode:p,setCode:m})=>{l.current=m,o.current=p,n.current&&m(n.current)},template:d})}catch(p){u(x._({id:"t3xUfw"})),console.error(p)}})(),()=>{typeof t=="function"&&t()}},[]),s.jsxs(h,{gap:"xs",style:{display:"flex",flex:1},children:[f&&s.jsx(R,{color:"red",title:x._({id:"JDFeOe"}),icon:s.jsx(g,{}),children:s.jsx(j,{children:f})}),s.jsx("div",{ref:i,style:{display:"flex",flex:1}})]})}),O=(r,d)=>e.forwardRef((a,c)=>{const i=e.useRef(),[f,u]=e.useState(void 0),n=e.useRef();return e.useImperativeHandle(c,()=>({updatePreview:(...l)=>{var o;return(o=n.current)==null?void 0:o.call(n,...l)}})),e.useEffect(()=>{(async()=>{try{r({ref:i.current,registerHandlers:({updatePreview:l})=>{n.current=l},template:d})}catch(l){u(x._({id:"KJx0of"})),console.error(l)}})()},[]),s.jsxs(h,{gap:"xs",style:{display:"flex",flex:1},children:[f&&s.jsx(R,{color:"red",title:x._({id:"OqfJdc"}),icon:s.jsx(g,{}),children:s.jsx(j,{children:f})}),s.jsx("div",{ref:i,style:{display:"flex",flex:1}})]})});function B({source:r,defaultFunctionName:d,context:a}){const c=e.useRef(),i=e.useRef(null);e.useEffect(()=>{c.current&&i.current===null&&(i.current=v.createRoot(c.current))},[i]);const[f,u]=e.useState(void 0),n=e.useMemo(()=>{const{getHost:o}=y.getState(),t=new URL(r,o());return t.pathname.includes(":")&&t.pathname.split(":")[1]||d},[r,d]),l=e.useCallback(()=>{if(!i.current)return;const o={...a,reloadContent:l};r&&d?b(r,n).then(t=>{var p;if(t)try{t.length>1?t(c.current,o):(p=i.current)==null||p.render(s.jsx(w,{client:_,api:C,children:s.jsx(E,{theme:o.theme,defaultColorScheme:o.colorScheme,children:s.jsx($,{children:t(o)})})})),u("")}catch(m){u(`${m}`),console.error(m)}else u(`${r} / ${t}`)}).catch(t=>{console.error(`ERR: Failed to load remote plugin function: ${r} /${n}`)}):u(`${x._({id:"wOa7Q9"})} - ${r} /${n}`)},[c.current,i.current,r,d,a]);return e.useEffect(()=>{l()},[n,i.current,a.id,a.model,a.instance,a.user,a.colorScheme,a.locale,a.context]),s.jsx(H,{label:S(`RemoteComponent-${n}`),children:s.jsxs(h,{gap:"xs",children:[f&&s.jsx(R,{color:"red",title:x._({id:"HY5802"}),icon:s.jsx(g,{}),children:s.jsxs(j,{children:[x._({id:"IYgnvh"}),": ",f]})}),c&&s.jsx("div",{ref:c})]})})}export{L as P,B as R,O as a,M as g};
//# sourceMappingURL=RemoteComponent-BK_-mK5N.js.map
