{"version":3,"file":"CategoryDetail-BpKgfphs.js","sources":["../../../../../../frontend/src/tables/part/ParametricPartTableFilters.tsx","../../../../../../frontend/src/tables/part/ParametricPartTable.tsx","../../../../../../frontend/src/tables/part/PartCategoryTable.tsx","../../../../../../frontend/src/pages/part/CategoryDetail.tsx"],"sourcesContent":["import { t } from '@lingui/core/macro';\nimport {\n  ActionIcon,\n  Divider,\n  Group,\n  Select,\n  Stack,\n  TextInput\n} from '@mantine/core';\nimport { IconCircleX } from '@tabler/icons-react';\nimport { useEffect, useMemo, useState } from 'react';\n\n// Define set of allowed operators for parameter filters\nexport const PARAMETER_FILTER_OPERATORS: Record<string, string> = {\n  '=': '',\n  '>': '_gt',\n  '>=': '_gte',\n  '<': '_lt',\n  '<=': '_lte',\n  '!=': '_ne',\n  '~': '_icontains'\n};\n\ntype ParameterFilterProps = {\n  template: any;\n  filters: any;\n  setFilter: (templateId: number, value: string, operator: string) => void;\n  clearFilter: (templateId: number, operator?: string) => void;\n  closeFilter: () => void;\n};\n\nfunction ClearFilterButton({\n  props,\n  operator\n}: {\n  props: ParameterFilterProps;\n  operator?: string;\n}) {\n  return (\n    <ActionIcon\n      aria-label={`clear-filter-${props.template.name}`}\n      variant='transparent'\n      color='red'\n      size='sm'\n      onClick={() => {\n        props.clearFilter(props.template.pk, operator ?? '');\n        props.closeFilter();\n      }}\n    >\n      <IconCircleX />\n    </ActionIcon>\n  );\n}\n\n/**\n * UI element for viewing and changing boolean filter associated with a given parameter template\n */\nfunction BooleanParameterFilter(props: ParameterFilterProps) {\n  const filterValue = useMemo(() => {\n    return props.filters['='] ?? '';\n  }, [props.filters]);\n\n  return (\n    <Select\n      aria-label={`filter-${props.template.name}`}\n      data={[\n        { value: 'true', label: t`True` },\n        { value: 'false', label: t`False` }\n      ]}\n      value={filterValue}\n      defaultValue={filterValue}\n      onChange={(val) => props.setFilter(props.template.pk, val ?? '', '=')}\n      placeholder={t`Select a choice`}\n      rightSection={<ClearFilterButton props={props} />}\n    />\n  );\n}\n\n/*\n * UI element for viewing and changing choice filter associated with a given parameter template.\n * In this case, the template defines a set of choices that can be selected.\n */\nfunction ChoiceParameterFilter(props: ParameterFilterProps) {\n  const filterValue = useMemo(() => {\n    return props.filters['='] ?? '';\n  }, [props.filters]);\n\n  return (\n    <Select\n      aria-label={`filter-${props.template.name}`}\n      data={props.template.choices\n        .split(',')\n        .map((choice: string) => choice.trim())}\n      value={filterValue}\n      defaultValue={filterValue}\n      onChange={(val) => props.setFilter(props.template.pk, val ?? '', '=')}\n      placeholder={t`Select a choice`}\n      searchable\n      rightSection={<ClearFilterButton props={props} />}\n    />\n  );\n}\n\nfunction GenericFilterRow({\n  props,\n  value,\n  operator,\n  readonly\n}: {\n  props: ParameterFilterProps;\n  value: string;\n  operator: string;\n  readonly?: boolean;\n}) {\n  const placeholder: string = useMemo(() => {\n    let placeholder = t`Enter a value`;\n\n    if (props.template.units) {\n      placeholder += ` [${props.template.units}]`;\n    }\n\n    return placeholder;\n  }, [props.template.units]);\n\n  const [op, setOp] = useState<string>(operator);\n\n  useEffect(() => {\n    setOp(operator);\n  }, [operator]);\n\n  return (\n    <Group gap='xs' wrap='nowrap'>\n      <div onMouseDown={(e) => e.stopPropagation()} style={{ width: 75 }}>\n        <Select\n          onClick={(event) => {\n            event?.stopPropagation();\n          }}\n          aria-label={`filter-${props.template.name}-operator`}\n          data={Object.keys(PARAMETER_FILTER_OPERATORS)}\n          value={op}\n          searchable={false}\n          clearable={false}\n          defaultValue={'='}\n          onChange={(value) => {\n            setOp(value ?? '=');\n          }}\n          size='sm'\n          disabled={readonly}\n          width={75}\n        />\n      </div>\n      <TextInput\n        aria-label={`filter-${props.template.name}`}\n        placeholder={placeholder}\n        defaultValue={value}\n        onKeyDown={(event) => {\n          if (event.key === 'Enter') {\n            props.setFilter(\n              props.template.pk,\n              event.currentTarget.value || '',\n              op\n            );\n            props.closeFilter();\n          }\n        }}\n        rightSection={\n          readonly && <ClearFilterButton props={props} operator={op} />\n        }\n      />\n    </Group>\n  );\n}\n\n/*\n * In this case, the template is generic and does not have a specific type.\n * Here, the user can apply multiple filter types (e.g., '=', '<', '>')\n */\nfunction GenericParameterFilter(props: ParameterFilterProps) {\n  return (\n    <Stack gap='xs'>\n      {/* Render a row for each operator defined in the filters object */}\n      {Object.keys(props.filters).map((operator) => {\n        return (\n          <GenericFilterRow\n            props={props}\n            value={props.filters[operator] ?? ''}\n            operator={operator}\n            readonly\n          />\n        );\n      })}\n      <Divider />\n      {/* Render an empty row for adding a new filter */}\n      <GenericFilterRow props={props} value='' operator='=' />\n    </Stack>\n  );\n}\n\n/**\n * UI element for viewing and changing filter(s) associated with a given parameter template\n * @param template - The parameter template object\n * @param filters - The current filters applied to the table\n * @param setFilter - Function to set a filter for the template\n * @param clearFilter - Function to clear the filter for the template\n * @param closeFilter - Function to close the filter UI\n */\nexport function ParameterFilter(props: ParameterFilterProps) {\n  // Filter input element (depends on template type)\n  return useMemo(() => {\n    if (props.template.checkbox) {\n      return <BooleanParameterFilter {...props} />;\n    } else if (!!props.template.choices) {\n      return <ChoiceParameterFilter {...props} />;\n    } else {\n      return <GenericParameterFilter {...props} />;\n    }\n  }, [props]);\n}\n","import { t } from '@lingui/core/macro';\nimport { Group } from '@mantine/core';\nimport { useHover } from '@mantine/hooks';\nimport { useQuery } from '@tanstack/react-query';\nimport { type ReactNode, useCallback, useMemo, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\n\nimport { YesNoButton } from '@lib/components/YesNoButton';\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { ModelType } from '@lib/enums/ModelType';\nimport { UserRoles } from '@lib/enums/Roles';\nimport { apiUrl } from '@lib/functions/Api';\nimport { cancelEvent } from '@lib/functions/Events';\nimport { getDetailUrl } from '@lib/functions/Navigation';\nimport { navigateToLink } from '@lib/functions/Navigation';\nimport type { TableFilter } from '@lib/types/Filters';\nimport type { ApiFormFieldSet } from '@lib/types/Forms';\nimport type { TableColumn } from '@lib/types/Tables';\nimport { useApi } from '../../contexts/ApiContext';\nimport { formatDecimal } from '../../defaults/formatters';\nimport { usePartParameterFields } from '../../forms/PartForms';\nimport {\n  useCreateApiFormModal,\n  useEditApiFormModal\n} from '../../hooks/UseForm';\nimport { useTable } from '../../hooks/UseTable';\nimport { useUserState } from '../../states/UserState';\nimport { DescriptionColumn, PartColumn } from '../ColumnRenderers';\nimport { InvenTreeTable } from '../InvenTreeTable';\nimport { TableHoverCard } from '../TableHoverCard';\nimport {\n  PARAMETER_FILTER_OPERATORS,\n  ParameterFilter\n} from './ParametricPartTableFilters';\n\n// Render an individual parameter cell\nfunction ParameterCell({\n  record,\n  template,\n  canEdit\n}: Readonly<{\n  record: any;\n  template: any;\n  canEdit: boolean;\n}>) {\n  const { hovered, ref } = useHover();\n\n  // Find matching template parameter\n  const parameter = useMemo(() => {\n    return record.parameters?.find((p: any) => p.template == template.pk);\n  }, [record.parameters, template]);\n\n  const extra: any[] = [];\n\n  // Format the value for display\n  const value: ReactNode = useMemo(() => {\n    let v: any = parameter?.data;\n\n    // Handle boolean values\n    if (template?.checkbox && v != undefined) {\n      v = <YesNoButton value={parameter.data} />;\n    }\n\n    return v;\n  }, [parameter, template]);\n\n  if (\n    template.units &&\n    parameter &&\n    parameter.data_numeric &&\n    parameter.data_numeric != parameter.data\n  ) {\n    const numeric = formatDecimal(parameter.data_numeric, { digits: 15 });\n    extra.push(`${numeric} [${template.units}]`);\n  }\n\n  if (hovered && canEdit) {\n    extra.push(t`Click to edit`);\n  }\n\n  return (\n    <div>\n      <Group grow ref={ref} justify='space-between'>\n        <Group grow>\n          <TableHoverCard\n            value={value ?? '-'}\n            extra={extra}\n            icon={hovered && canEdit ? 'edit' : 'info'}\n            title={template.name}\n          />\n        </Group>\n      </Group>\n    </div>\n  );\n}\n\nexport default function ParametricPartTable({\n  categoryId\n}: Readonly<{\n  categoryId?: any;\n}>) {\n  const api = useApi();\n  const table = useTable('parametric-parts');\n  const user = useUserState();\n  const navigate = useNavigate();\n\n  const categoryParameters = useQuery({\n    queryKey: ['category-parameters', categoryId],\n    queryFn: async () => {\n      return api\n        .get(apiUrl(ApiEndpoints.part_parameter_template_list), {\n          params: {\n            category: categoryId\n          }\n        })\n        .then((response) => response.data);\n    },\n    refetchOnMount: true\n  });\n\n  /* Store filters against selected part parameters.\n   * These are stored in the format:\n   * {\n   *   parameter_1: {\n   *    '=': 'value1',\n   *    '<': 'value2',\n   *    ...\n   *   },\n   *   parameter_2: {\n   *    '=': 'value3',\n   *   },\n   *   ...\n   * }\n   *\n   * Which allows multiple filters to be applied against each parameter template.\n   */\n  const [parameterFilters, setParameterFilters] = useState<any>({});\n\n  /* Remove filters for a specific parameter template\n   * - If no operator is specified, remove all filters for this template\n   * - If an operator is specified, remove filters for that operator only\n   */\n  const clearParameterFilter = useCallback(\n    (templateId: number, operator?: string) => {\n      const filterName = `parameter_${templateId}`;\n\n      if (!operator) {\n        // If no operator is specified, remove all filters for this template\n        setParameterFilters((prev: any) => {\n          const newFilters = { ...prev };\n          // Remove any filters that match the template ID\n          Object.keys(newFilters).forEach((key: string) => {\n            if (key == filterName) {\n              delete newFilters[key];\n            }\n          });\n          return newFilters;\n        });\n\n        return;\n      }\n\n      // An operator is specified, so we remove filters for that operator only\n      setParameterFilters((prev: any) => {\n        const filters = { ...prev };\n\n        const paramFilters = filters[filterName] || {};\n\n        if (paramFilters[operator]) {\n          // Remove the specific operator filter\n          delete paramFilters[operator];\n        }\n\n        return {\n          ...filters,\n          [filterName]: paramFilters\n        };\n      });\n\n      table.refreshTable();\n    },\n    [setParameterFilters, table.refreshTable]\n  );\n\n  /**\n   * Add (or update) a filter for a specific parameter template.\n   * @param templateId - The ID of the parameter template to filter on.\n   * @param value - The value to filter by.\n   * @param operator - The operator to use for filtering (e.g., '=', '<', '>', etc.).\n   */\n  const addParameterFilter = useCallback(\n    (templateId: number, value: string, operator: string) => {\n      const filterName = `parameter_${templateId}`;\n\n      setParameterFilters((prev: any) => {\n        const filters = { ...prev };\n        const paramFilters = filters[filterName] || {};\n\n        paramFilters[operator] = value;\n\n        return {\n          ...filters,\n          [filterName]: paramFilters\n        };\n      });\n\n      table.refreshTable();\n    },\n    [setParameterFilters, clearParameterFilter, table.refreshTable]\n  );\n\n  // Construct the query filters for the table based on the parameter filters\n  const parametricQueryFilters = useMemo(() => {\n    const filters: Record<string, string> = {};\n\n    Object.keys(parameterFilters).forEach((key: string) => {\n      const paramFilters: any = parameterFilters[key];\n\n      Object.keys(paramFilters).forEach((operator: string) => {\n        const name = `${key}${PARAMETER_FILTER_OPERATORS[operator] || ''}`;\n        const value = paramFilters[operator];\n\n        filters[name] = value;\n      });\n    });\n\n    return filters;\n  }, [parameterFilters]);\n\n  const [selectedPart, setSelectedPart] = useState<number>(0);\n  const [selectedTemplate, setSelectedTemplate] = useState<number>(0);\n  const [selectedParameter, setSelectedParameter] = useState<number>(0);\n\n  const partParameterFields: ApiFormFieldSet = usePartParameterFields({\n    editTemplate: false\n  });\n\n  const addParameter = useCreateApiFormModal({\n    url: ApiEndpoints.part_parameter_list,\n    title: t`Add Part Parameter`,\n    fields: useMemo(() => ({ ...partParameterFields }), [partParameterFields]),\n    focus: 'data',\n    onFormSuccess: (parameter: any) => {\n      updateParameterRecord(selectedPart, parameter);\n    },\n    initialData: {\n      part: selectedPart,\n      template: selectedTemplate\n    }\n  });\n\n  const editParameter = useEditApiFormModal({\n    url: ApiEndpoints.part_parameter_list,\n    title: t`Edit Part Parameter`,\n    pk: selectedParameter,\n    fields: useMemo(() => ({ ...partParameterFields }), [partParameterFields]),\n    focus: 'data',\n    onFormSuccess: (parameter: any) => {\n      updateParameterRecord(selectedPart, parameter);\n    }\n  });\n\n  // Update a single parameter record in the table\n  const updateParameterRecord = useCallback(\n    (part: number, parameter: any) => {\n      const records = table.records;\n      const partIndex = records.findIndex((record: any) => record.pk == part);\n\n      if (partIndex < 0) {\n        // No matching part: reload the entire table\n        table.refreshTable();\n        return;\n      }\n\n      const parameterIndex = records[partIndex].parameters.findIndex(\n        (p: any) => p.pk == parameter.pk\n      );\n\n      if (parameterIndex < 0) {\n        // No matching parameter - append new parameter\n        records[partIndex].parameters.push(parameter);\n      } else {\n        records[partIndex].parameters[parameterIndex] = parameter;\n      }\n\n      table.updateRecord(records[partIndex]);\n    },\n    [table.updateRecord]\n  );\n\n  const parameterColumns: TableColumn[] = useMemo(() => {\n    const data = categoryParameters?.data || [];\n\n    return data.map((template: any) => {\n      let title = template.name;\n\n      if (template.units) {\n        title += ` [${template.units}]`;\n      }\n\n      const filters = parameterFilters[`parameter_${template.pk}`] || {};\n\n      return {\n        accessor: `parameter_${template.pk}`,\n        title: title,\n        sortable: true,\n        extra: {\n          template: template.pk\n        },\n        render: (record: any) => (\n          <ParameterCell\n            record={record}\n            template={template}\n            canEdit={user.hasChangeRole(UserRoles.part)}\n          />\n        ),\n        filtering: Object.keys(filters).length > 0,\n        filter: ({ close }: { close: () => void }) => {\n          return (\n            <ParameterFilter\n              template={template}\n              filters={parameterFilters[`parameter_${template.pk}`] || {}}\n              setFilter={addParameterFilter}\n              clearFilter={clearParameterFilter}\n              closeFilter={close}\n            />\n          );\n        }\n      };\n    });\n  }, [user, categoryParameters.data, parameterFilters]);\n\n  const onParameterClick = useCallback((template: number, part: any) => {\n    setSelectedTemplate(template);\n    setSelectedPart(part.pk);\n    const parameter = part.parameters?.find((p: any) => p.template == template);\n\n    if (parameter) {\n      setSelectedParameter(parameter.pk);\n      editParameter.open();\n    } else {\n      addParameter.open();\n    }\n  }, []);\n\n  const tableFilters: TableFilter[] = useMemo(() => {\n    return [\n      {\n        name: 'active',\n        label: t`Active`,\n        description: t`Show active parts`\n      },\n      {\n        name: 'locked',\n        label: t`Locked`,\n        description: t`Show locked parts`\n      },\n      {\n        name: 'assembly',\n        label: t`Assembly`,\n        description: t`Show assembly parts`\n      }\n    ];\n  }, []);\n\n  const tableColumns: TableColumn[] = useMemo(() => {\n    const partColumns: TableColumn[] = [\n      {\n        accessor: 'name',\n        title: t`Part`,\n        sortable: true,\n        switchable: false,\n        noWrap: true,\n        render: (record: any) => PartColumn({ part: record })\n      },\n      DescriptionColumn({\n        defaultVisible: false\n      }),\n      {\n        accessor: 'IPN',\n        sortable: true,\n        defaultVisible: false\n      },\n      {\n        accessor: 'total_in_stock',\n        sortable: true\n      }\n    ];\n\n    return [...partColumns, ...parameterColumns];\n  }, [parameterColumns]);\n\n  return (\n    <>\n      {addParameter.modal}\n      {editParameter.modal}\n      <InvenTreeTable\n        url={apiUrl(ApiEndpoints.part_list)}\n        tableState={table}\n        columns={tableColumns}\n        props={{\n          enableDownload: true,\n          tableFilters: tableFilters,\n          params: {\n            category: categoryId,\n            cascade: true,\n            category_detail: true,\n            parameters: true,\n            ...parametricQueryFilters\n          },\n          onCellClick: ({ event, record, index, column, columnIndex }) => {\n            cancelEvent(event);\n\n            // Is this a \"parameter\" cell?\n            if (column?.accessor?.toString()?.startsWith('parameter_')) {\n              const col = column as any;\n              onParameterClick(col.extra.template, record);\n            } else if (record?.pk) {\n              // Navigate through to the part detail page\n              const url = getDetailUrl(ModelType.part, record.pk);\n              navigateToLink(url, navigate, event);\n            }\n          }\n        }}\n      />\n    </>\n  );\n}\n","import { t } from '@lingui/core/macro';\nimport { Group, Tooltip } from '@mantine/core';\nimport { IconBell } from '@tabler/icons-react';\nimport { useCallback, useMemo, useState } from 'react';\n\nimport { AddItemButton } from '@lib/components/AddItemButton';\nimport { type RowAction, RowEditAction } from '@lib/components/RowActions';\nimport { YesNoButton } from '@lib/components/YesNoButton';\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { ModelType } from '@lib/enums/ModelType';\nimport { UserRoles } from '@lib/enums/Roles';\nimport { apiUrl } from '@lib/functions/Api';\nimport type { TableFilter } from '@lib/types/Filters';\nimport type { TableColumn } from '@lib/types/Tables';\nimport { ActionDropdown } from '../../components/items/ActionDropdown';\nimport { ApiIcon } from '../../components/items/ApiIcon';\nimport { partCategoryFields } from '../../forms/PartForms';\nimport { InvenTreeIcon } from '../../functions/icons';\nimport {\n  useBulkEditApiFormModal,\n  useCreateApiFormModal,\n  useEditApiFormModal\n} from '../../hooks/UseForm';\nimport { useTable } from '../../hooks/UseTable';\nimport { useUserState } from '../../states/UserState';\nimport { DescriptionColumn } from '../ColumnRenderers';\nimport { InvenTreeTable } from '../InvenTreeTable';\n\n/**\n * PartCategoryTable - Displays a table of part categories\n */\nexport function PartCategoryTable({ parentId }: Readonly<{ parentId?: any }>) {\n  const table = useTable('partcategory');\n  const user = useUserState();\n\n  const tableColumns: TableColumn[] = useMemo(() => {\n    return [\n      {\n        accessor: 'name',\n        sortable: true,\n        switchable: false,\n        render: (record: any) => (\n          <Group gap='xs' wrap='nowrap' justify='space-between'>\n            <Group gap='xs' wrap='nowrap'>\n              {record.icon && <ApiIcon name={record.icon} />}\n              {record.name}\n            </Group>\n            <Group gap='xs' justify='flex-end' wrap='nowrap'>\n              {record.starred && (\n                <Tooltip\n                  label={t`You are subscribed to notifications for this category`}\n                >\n                  <IconBell color='green' size={16} />\n                </Tooltip>\n              )}\n            </Group>\n          </Group>\n        )\n      },\n      DescriptionColumn({}),\n      {\n        accessor: 'pathstring',\n        sortable: false\n      },\n      {\n        accessor: 'structural',\n        sortable: true,\n        defaultVisible: false,\n        render: (record: any) => {\n          return <YesNoButton value={record.structural} />;\n        }\n      },\n      {\n        accessor: 'part_count',\n        sortable: true\n      }\n    ];\n  }, []);\n\n  const tableFilters: TableFilter[] = useMemo(() => {\n    return [\n      {\n        name: 'cascade',\n        label: t`Include Subcategories`,\n        description: t`Include subcategories in results`\n      },\n      {\n        name: 'structural',\n        label: t`Structural`,\n        description: t`Show structural categories`\n      },\n      {\n        name: 'starred',\n        label: t`Subscribed`,\n        description: t`Show categories to which the user is subscribed`\n      }\n    ];\n  }, []);\n\n  const newCategoryFields = partCategoryFields({ create: true });\n\n  const newCategory = useCreateApiFormModal({\n    url: ApiEndpoints.category_list,\n    title: t`New Part Category`,\n    fields: newCategoryFields,\n    focus: 'name',\n    initialData: {\n      parent: parentId\n    },\n    follow: true,\n    modelType: ModelType.partcategory,\n    table: table\n  });\n\n  const [selectedCategory, setSelectedCategory] = useState<number>(-1);\n\n  const editCategoryFields = partCategoryFields({ create: false });\n\n  const editCategory = useEditApiFormModal({\n    url: ApiEndpoints.category_list,\n    pk: selectedCategory,\n    title: t`Edit Part Category`,\n    fields: editCategoryFields,\n    onFormSuccess: (record: any) => table.updateRecord(record)\n  });\n\n  const setParent = useBulkEditApiFormModal({\n    url: ApiEndpoints.category_list,\n    items: table.selectedIds,\n    title: t`Set Parent Category`,\n    fields: {\n      parent: {}\n    },\n    onFormSuccess: table.refreshTable\n  });\n\n  const tableActions = useMemo(() => {\n    const can_add = user.hasAddRole(UserRoles.part_category);\n    const can_edit = user.hasChangeRole(UserRoles.part_category);\n\n    return [\n      <ActionDropdown\n        tooltip={t`Category Actions`}\n        icon={<InvenTreeIcon icon='category' />}\n        disabled={!table.hasSelectedRecords}\n        actions={[\n          {\n            name: t`Set Parent`,\n            icon: <InvenTreeIcon icon='category' />,\n            tooltip: t`Set parent category for the selected items`,\n            hidden: !can_edit,\n            disabled: !table.hasSelectedRecords,\n            onClick: () => {\n              setParent.open();\n            }\n          }\n        ]}\n      />,\n      <AddItemButton\n        key='add-part-category'\n        tooltip={t`Add Part Category`}\n        onClick={() => newCategory.open()}\n        hidden={!can_add}\n      />\n    ];\n  }, [user, table.hasSelectedRecords]);\n\n  const rowActions = useCallback(\n    (record: any): RowAction[] => {\n      const can_edit = user.hasChangeRole(UserRoles.part_category);\n\n      return [\n        RowEditAction({\n          hidden: !can_edit,\n          onClick: () => {\n            setSelectedCategory(record.pk);\n            editCategory.open();\n          }\n        })\n      ];\n    },\n    [user]\n  );\n\n  return (\n    <>\n      {newCategory.modal}\n      {editCategory.modal}\n      {setParent.modal}\n      <InvenTreeTable\n        url={apiUrl(ApiEndpoints.category_list)}\n        tableState={table}\n        columns={tableColumns}\n        props={{\n          enableDownload: true,\n          enableSelection: true,\n          params: {\n            parent: parentId,\n            top_level: parentId === undefined ? true : undefined\n          },\n          tableFilters: tableFilters,\n          tableActions: tableActions,\n          rowActions: rowActions,\n          modelType: ModelType.partcategory\n        }}\n      />\n    </>\n  );\n}\n","import { t } from '@lingui/core/macro';\nimport { Group, LoadingOverlay, Skeleton, Stack, Text } from '@mantine/core';\nimport {\n  IconCategory,\n  IconInfoCircle,\n  IconListDetails,\n  IconPackages,\n  IconSitemap\n} from '@tabler/icons-react';\nimport { useMemo, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\n\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { ModelType } from '@lib/enums/ModelType';\nimport { UserRoles } from '@lib/enums/Roles';\nimport { getDetailUrl } from '@lib/functions/Navigation';\nimport AdminButton from '../../components/buttons/AdminButton';\nimport StarredToggleButton from '../../components/buttons/StarredToggleButton';\nimport {\n  type DetailsField,\n  DetailsTable\n} from '../../components/details/Details';\nimport { ItemDetailsGrid } from '../../components/details/ItemDetails';\nimport {\n  DeleteItemAction,\n  EditItemAction,\n  OptionsActionDropdown\n} from '../../components/items/ActionDropdown';\nimport { ApiIcon } from '../../components/items/ApiIcon';\nimport InstanceDetail from '../../components/nav/InstanceDetail';\nimport NavigationTree from '../../components/nav/NavigationTree';\nimport { PageDetail } from '../../components/nav/PageDetail';\nimport type { PanelType } from '../../components/panels/Panel';\nimport { PanelGroup } from '../../components/panels/PanelGroup';\nimport { partCategoryFields } from '../../forms/PartForms';\nimport {\n  useDeleteApiFormModal,\n  useEditApiFormModal\n} from '../../hooks/UseForm';\nimport { useInstance } from '../../hooks/UseInstance';\nimport { useUserState } from '../../states/UserState';\nimport ParametricPartTable from '../../tables/part/ParametricPartTable';\nimport { PartCategoryTable } from '../../tables/part/PartCategoryTable';\nimport { PartListTable } from '../../tables/part/PartTable';\nimport { StockItemTable } from '../../tables/stock/StockItemTable';\n\n/**\n * Detail view for a single PartCategory instance.\n *\n * Note: If no category ID is supplied, this acts as the top-level part category page\n */\nexport default function CategoryDetail() {\n  const { id: _id } = useParams();\n  const id = useMemo(\n    () => (!Number.isNaN(Number.parseInt(_id || '')) ? _id : undefined),\n    [_id]\n  );\n\n  const navigate = useNavigate();\n  const user = useUserState();\n\n  const [treeOpen, setTreeOpen] = useState(false);\n\n  const {\n    instance: category,\n    refreshInstance,\n    instanceQuery\n  } = useInstance({\n    endpoint: ApiEndpoints.category_list,\n    hasPrimaryKey: true,\n    pk: id,\n    params: {\n      path_detail: true\n    }\n  });\n\n  const detailsPanel = useMemo(() => {\n    if (id && instanceQuery.isFetching) {\n      return <Skeleton />;\n    }\n\n    const left: DetailsField[] = [\n      {\n        type: 'text',\n        name: 'name',\n        label: t`Name`,\n        copy: true,\n        value_formatter: () => (\n          <Group gap='xs'>\n            {category.icon && <ApiIcon name={category.icon} />}\n            {category.name}\n          </Group>\n        )\n      },\n      {\n        type: 'text',\n        name: 'pathstring',\n        label: t`Path`,\n        icon: 'sitemap',\n        copy: true,\n        hidden: !id\n      },\n      {\n        type: 'text',\n        name: 'description',\n        label: t`Description`,\n        copy: true\n      },\n      {\n        type: 'link',\n        name: 'parent',\n        model_field: 'name',\n        icon: 'location',\n        label: t`Parent Category`,\n        model: ModelType.partcategory,\n        hidden: !category?.parent\n      },\n      {\n        type: 'boolean',\n        name: 'starred',\n        icon: 'notification',\n        label: t`Subscribed`\n      }\n    ];\n\n    const right: DetailsField[] = [\n      {\n        type: 'text',\n        name: 'part_count',\n        label: t`Parts`,\n        icon: 'part',\n        value_formatter: () => category?.part_count || '0'\n      },\n      {\n        type: 'text',\n        name: 'subcategories',\n        label: t`Subcategories`,\n        icon: 'sitemap',\n        hidden: !category?.subcategories\n      },\n      {\n        type: 'boolean',\n        name: 'structural',\n        label: t`Structural`,\n        icon: 'sitemap'\n      },\n      {\n        type: 'link',\n        name: 'parent_default_location',\n        label: t`Parent default location`,\n        model: ModelType.stocklocation,\n        hidden: !category.parent_default_location || category.default_location\n      },\n      {\n        type: 'link',\n        name: 'default_location',\n        label: t`Default location`,\n        model: ModelType.stocklocation,\n        hidden: !category.default_location\n      }\n    ];\n\n    return (\n      <ItemDetailsGrid>\n        {id && category?.pk ? (\n          <DetailsTable item={category} fields={left} />\n        ) : (\n          <Text>{t`Top level part category`}</Text>\n        )}\n        {id && category?.pk && <DetailsTable item={category} fields={right} />}\n      </ItemDetailsGrid>\n    );\n  }, [category, instanceQuery]);\n\n  const editCategory = useEditApiFormModal({\n    url: ApiEndpoints.category_list,\n    pk: id,\n    title: t`Edit Part Category`,\n    fields: partCategoryFields({}),\n    onFormSuccess: refreshInstance\n  });\n\n  const deleteOptions = useMemo(() => {\n    return [\n      {\n        value: 0,\n        display_name: t`Move items to parent category`\n      },\n      {\n        value: 1,\n        display_name: t`Delete items`\n      }\n    ];\n  }, []);\n\n  const deleteCategory = useDeleteApiFormModal({\n    url: ApiEndpoints.category_list,\n    pk: id,\n    title: t`Delete Part Category`,\n    fields: {\n      delete_parts: {\n        label: t`Parts Action`,\n        description: t`Action for parts in this category`,\n        choices: deleteOptions,\n        field_type: 'choice'\n      },\n      delete_child_categories: {\n        label: t`Child Categories Action`,\n        description: t`Action for child categories in this category`,\n        choices: deleteOptions,\n        field_type: 'choice'\n      }\n    },\n    onFormSuccess: () => {\n      if (category.parent) {\n        navigate(getDetailUrl(ModelType.partcategory, category.parent));\n      } else {\n        navigate('/part/');\n      }\n    }\n  });\n\n  const categoryActions = useMemo(() => {\n    return [\n      <AdminButton\n        key='admin'\n        model={ModelType.partcategory}\n        id={category.pk}\n      />,\n      <StarredToggleButton\n        key='starred_change'\n        instance={category}\n        model={ModelType.partcategory}\n        successFunction={() => {\n          refreshInstance();\n        }}\n      />,\n      <OptionsActionDropdown\n        key='category-actions'\n        tooltip={t`Category Actions`}\n        actions={[\n          EditItemAction({\n            hidden: !id || !user.hasChangeRole(UserRoles.part_category),\n            tooltip: t`Edit Part Category`,\n            onClick: () => editCategory.open()\n          }),\n          DeleteItemAction({\n            hidden: !id || !user.hasDeleteRole(UserRoles.part_category),\n            tooltip: t`Delete Part Category`,\n            onClick: () => deleteCategory.open()\n          })\n        ]}\n      />\n    ];\n  }, [id, user, category.pk, category.starred]);\n\n  const panels: PanelType[] = useMemo(\n    () => [\n      {\n        name: 'details',\n        label: t`Category Details`,\n        icon: <IconInfoCircle />,\n        content: detailsPanel\n      },\n      {\n        name: 'subcategories',\n        label: t`Subcategories`,\n        icon: <IconSitemap />,\n        content: <PartCategoryTable parentId={id} />\n      },\n      {\n        name: 'parts',\n        label: t`Parts`,\n        icon: <IconCategory />,\n        content: (\n          <PartListTable\n            props={{\n              params: {\n                category: id\n              }\n            }}\n          />\n        )\n      },\n      {\n        name: 'stockitem',\n        label: t`Stock Items`,\n        icon: <IconPackages />,\n        hidden: !id,\n        content: (\n          <StockItemTable\n            params={{\n              category: id\n            }}\n            allowAdd={false}\n            tableName='category-stockitems'\n          />\n        )\n      },\n      {\n        name: 'parameters',\n        label: t`Part Parameters`,\n        icon: <IconListDetails />,\n        content: <ParametricPartTable categoryId={id} />\n      }\n    ],\n    [category, id]\n  );\n\n  const breadcrumbs = useMemo(\n    () => [\n      { name: t`Parts`, url: '/part' },\n      ...(category.path ?? []).map((c: any) => ({\n        name: c.name,\n        url: getDetailUrl(ModelType.partcategory, c.pk),\n        icon: c.icon ? <ApiIcon name={c.icon} /> : undefined\n      }))\n    ],\n    [category]\n  );\n\n  return (\n    <>\n      {editCategory.modal}\n      {deleteCategory.modal}\n      <InstanceDetail\n        query={instanceQuery}\n        requiredRole={UserRoles.part_category}\n      >\n        <Stack gap='xs'>\n          <LoadingOverlay visible={instanceQuery.isFetching} />\n          <NavigationTree\n            modelType={ModelType.partcategory}\n            title={t`Part Categories`}\n            endpoint={ApiEndpoints.category_tree}\n            opened={treeOpen}\n            onClose={() => {\n              setTreeOpen(false);\n            }}\n            selectedId={category?.pk}\n          />\n          <PageDetail\n            title={category?.name ?? t`Part Category`}\n            subtitle={category?.description}\n            icon={category?.icon && <ApiIcon name={category?.icon} />}\n            breadcrumbs={breadcrumbs}\n            breadcrumbAction={() => {\n              setTreeOpen(true);\n            }}\n            actions={categoryActions}\n            editAction={editCategory.open}\n            editEnabled={\n              !!category?.pk && user.hasChangePermission(ModelType.partcategory)\n            }\n          />\n          <PanelGroup\n            pageKey='partcategory'\n            panels={panels}\n            model={ModelType.partcategory}\n            instance={category}\n            reloadInstance={refreshInstance}\n            id={category.pk ?? null}\n          />\n        </Stack>\n      </InstanceDetail>\n    </>\n  );\n}\n"],"names":["PARAMETER_FILTER_OPERATORS","ClearFilterButton","props","operator","jsx","ActionIcon","template","name","clearFilter","pk","closeFilter","IconCircleX","BooleanParameterFilter","filterValue","useMemo","filters","Select","value","label","_i18n","_","id","setFilter","val","ChoiceParameterFilter","choices","split","map","choice","trim","GenericFilterRow","readonly","placeholder","units","op","setOp","useState","useEffect","jsxs","Group","e","stopPropagation","width","event","Object","keys","TextInput","key","currentTarget","GenericParameterFilter","Stack","Divider","ParameterFilter","checkbox","ParameterCell","record","canEdit","hovered","ref","useHover","parameter","parameters","find","p","extra","v","data","undefined","YesNoButton","data_numeric","numeric","formatDecimal","digits","push","TableHoverCard","ParametricPartTable","categoryId","api","useApi","table","useTable","user","useUserState","navigate","useNavigate","categoryParameters","useQuery","queryKey","queryFn","get","apiUrl","ApiEndpoints","part_parameter_template_list","params","category","then","response","refetchOnMount","parameterFilters","setParameterFilters","clearParameterFilter","useCallback","templateId","filterName","prev","newFilters","forEach","paramFilters","refreshTable","addParameterFilter","parametricQueryFilters","selectedPart","setSelectedPart","selectedTemplate","setSelectedTemplate","selectedParameter","setSelectedParameter","partParameterFields","usePartParameterFields","editTemplate","addParameter","useCreateApiFormModal","url","part_parameter_list","title","fields","focus","onFormSuccess","updateParameterRecord","initialData","part","editParameter","useEditApiFormModal","records","partIndex","findIndex","parameterIndex","updateRecord","parameterColumns","accessor","sortable","render","hasChangeRole","UserRoles","filtering","length","filter","close","onParameterClick","open","tableFilters","description","tableColumns","switchable","noWrap","PartColumn","DescriptionColumn","defaultVisible","modal","InvenTreeTable","part_list","enableDownload","cascade","category_detail","onCellClick","index","column","columnIndex","cancelEvent","toString","startsWith","col","getDetailUrl","ModelType","PartCategoryTable","parentId","icon","ApiIcon","starred","Tooltip","IconBell","structural","newCategoryFields","partCategoryFields","create","newCategory","category_list","parent","follow","modelType","partcategory","selectedCategory","setSelectedCategory","editCategoryFields","editCategory","setParent","useBulkEditApiFormModal","items","selectedIds","tableActions","can_add","hasAddRole","part_category","can_edit","ActionDropdown","InvenTreeIcon","hasSelectedRecords","tooltip","hidden","disabled","onClick","AddItemButton","rowActions","RowEditAction","enableSelection","top_level","CategoryDetail","_id","useParams","Number","isNaN","parseInt","treeOpen","setTreeOpen","instance","refreshInstance","instanceQuery","useInstance","endpoint","hasPrimaryKey","path_detail","detailsPanel","isFetching","Skeleton","left","type","copy","value_formatter","model_field","model","right","part_count","subcategories","stocklocation","parent_default_location","default_location","ItemDetailsGrid","DetailsTable","Text","deleteOptions","display_name","deleteCategory","useDeleteApiFormModal","delete_parts","field_type","delete_child_categories","categoryActions","AdminButton","StarredToggleButton","OptionsActionDropdown","EditItemAction","DeleteItemAction","hasDeleteRole","panels","IconInfoCircle","content","IconSitemap","IconCategory","PartListTable","IconPackages","StockItemTable","IconListDetails","breadcrumbs","path","c","InstanceDetail","LoadingOverlay","NavigationTree","category_tree","PageDetail","hasChangePermission","PanelGroup"],"mappings":"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"}
