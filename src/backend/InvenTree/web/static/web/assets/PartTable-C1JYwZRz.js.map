{"version":3,"file":"PartTable-C1JYwZRz.js","sources":["../../../../../../frontend/src/forms/PartForms.tsx","../../../../../../frontend/src/tables/part/PartTable.tsx"],"sourcesContent":["import { t } from '@lingui/core/macro';\nimport { IconPackages } from '@tabler/icons-react';\nimport { useMemo, useState } from 'react';\n\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { apiUrl } from '@lib/functions/Api';\nimport type { ApiFormFieldSet } from '@lib/types/Forms';\nimport { useApi } from '../contexts/ApiContext';\nimport { useGlobalSettingsState } from '../states/SettingsStates';\n\n/**\n * Construct a set of fields for creating / editing a Part instance\n */\nexport function usePartFields({\n  create = false\n}: {\n  create?: boolean;\n}): ApiFormFieldSet {\n  const settings = useGlobalSettingsState();\n\n  return useMemo(() => {\n    const fields: ApiFormFieldSet = {\n      category: {\n        filters: {\n          structural: false\n        }\n      },\n      name: {},\n      IPN: {},\n      description: {},\n      revision: {},\n      revision_of: {\n        filters: {\n          is_revision: false,\n          is_template: false\n        }\n      },\n      variant_of: {\n        filters: {\n          is_template: true\n        }\n      },\n      keywords: {},\n      units: {},\n      link: {},\n      default_location: {\n        filters: {\n          structural: false\n        }\n      },\n      default_expiry: {},\n      minimum_stock: {},\n      responsible: {\n        filters: {\n          is_active: true\n        }\n      },\n      component: {},\n      assembly: {},\n      is_template: {},\n      testable: {},\n      trackable: {},\n      purchaseable: {},\n      salable: {},\n      virtual: {},\n      locked: {},\n      active: {},\n      starred: {\n        field_type: 'boolean',\n        label: t`Subscribed`,\n        description: t`Subscribe to notifications for this part`,\n        disabled: false,\n        required: false\n      }\n    };\n\n    // Additional fields for creation\n    if (create) {\n      fields.copy_category_parameters = {};\n\n      fields.initial_stock = {\n        icon: <IconPackages />,\n        children: {\n          quantity: {\n            value: 0\n          },\n          location: {}\n        }\n      };\n\n      fields.initial_supplier = {\n        children: {\n          supplier: {\n            filters: {\n              is_supplier: true\n            }\n          },\n          sku: {},\n          manufacturer: {\n            filters: {\n              is_manufacturer: true\n            }\n          },\n          mpn: {}\n        }\n      };\n    }\n\n    if (settings.isSet('PART_REVISION_ASSEMBLY_ONLY')) {\n      fields.revision_of.filters['assembly'] = true;\n    }\n\n    // Pop 'revision' field if PART_ENABLE_REVISION is False\n    if (!settings.isSet('PART_ENABLE_REVISION')) {\n      delete fields['revision'];\n      delete fields['revision_of'];\n    }\n\n    // Pop 'expiry' field if expiry not enabled\n    if (!settings.isSet('STOCK_ENABLE_EXPIRY')) {\n      delete fields['default_expiry'];\n    }\n\n    if (create) {\n      delete fields['starred'];\n    }\n\n    return fields;\n  }, [create, settings]);\n}\n\n/**\n * Construct a set of fields for creating / editing a PartCategory instance\n */\nexport function partCategoryFields({\n  create\n}: {\n  create?: boolean;\n}): ApiFormFieldSet {\n  const fields: ApiFormFieldSet = useMemo(() => {\n    const fields: ApiFormFieldSet = {\n      parent: {\n        description: t`Parent part category`,\n        required: false\n      },\n      name: {},\n      description: {},\n      default_location: {\n        filters: {\n          structural: false\n        }\n      },\n      default_keywords: {},\n      structural: {},\n      starred: {\n        field_type: 'boolean',\n        label: t`Subscribed`,\n        description: t`Subscribe to notifications for this category`,\n        disabled: false,\n        required: false\n      },\n      icon: {\n        field_type: 'icon'\n      }\n    };\n\n    if (create) {\n      delete fields['starred'];\n    }\n\n    return fields;\n  }, [create]);\n\n  return fields;\n}\n\nexport function usePartParameterFields({\n  editTemplate\n}: {\n  editTemplate?: boolean;\n}): ApiFormFieldSet {\n  const api = useApi();\n\n  // Valid field choices\n  const [choices, setChoices] = useState<any[]>([]);\n\n  // Field type for \"data\" input\n  const [fieldType, setFieldType] = useState<'string' | 'boolean' | 'choice'>(\n    'string'\n  );\n\n  return useMemo(() => {\n    return {\n      part: {\n        disabled: true\n      },\n      template: {\n        disabled: editTemplate == false,\n        onValueChange: (value: any, record: any) => {\n          // Adjust the type of the \"data\" field based on the selected template\n          if (record?.checkbox) {\n            // This is a \"checkbox\" field\n            setChoices([]);\n            setFieldType('boolean');\n          } else if (record?.choices) {\n            const _choices: string[] = record.choices.split(',');\n\n            if (_choices.length > 0) {\n              setChoices(\n                _choices.map((choice) => {\n                  return {\n                    display_name: choice.trim(),\n                    value: choice.trim()\n                  };\n                })\n              );\n              setFieldType('choice');\n            } else {\n              setChoices([]);\n              setFieldType('string');\n            }\n          } else if (record?.selectionlist) {\n            api\n              .get(\n                apiUrl(ApiEndpoints.selectionlist_detail, record.selectionlist)\n              )\n              .then((res) => {\n                setChoices(\n                  res.data.choices.map((item: any) => {\n                    return {\n                      value: item.value,\n                      display_name: item.label\n                    };\n                  })\n                );\n                setFieldType('choice');\n              });\n          } else {\n            setChoices([]);\n            setFieldType('string');\n          }\n        }\n      },\n      data: {\n        type: fieldType,\n        field_type: fieldType,\n        choices: fieldType === 'choice' ? choices : undefined,\n        default: fieldType === 'boolean' ? false : undefined,\n        adjustValue: (value: any) => {\n          // Coerce boolean value into a string (required by backend)\n\n          let v: string = value.toString().trim();\n\n          if (fieldType === 'boolean') {\n            if (v.toLowerCase() !== 'true') {\n              v = 'false';\n            }\n          }\n\n          return v;\n        }\n      },\n      note: {}\n    };\n  }, [editTemplate, fieldType, choices]);\n}\n\nexport function partStocktakeFields(): ApiFormFieldSet {\n  return {\n    part: {\n      hidden: true\n    },\n    quantity: {},\n    item_count: {},\n    cost_min: {},\n    cost_min_currency: {},\n    cost_max: {},\n    cost_max_currency: {},\n    note: {}\n  };\n}\n","import { t } from '@lingui/core/macro';\nimport { Group, Text } from '@mantine/core';\nimport { IconShoppingCart } from '@tabler/icons-react';\nimport { type ReactNode, useCallback, useMemo, useState } from 'react';\n\nimport { AddItemButton } from '@lib/components/AddItemButton';\nimport { type RowAction, RowEditAction } from '@lib/components/RowActions';\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { ModelType } from '@lib/enums/ModelType';\nimport { UserRoles } from '@lib/enums/Roles';\nimport { apiUrl } from '@lib/functions/Api';\nimport type { TableFilter } from '@lib/types/Filters';\nimport type { TableColumn } from '@lib/types/Tables';\nimport type { InvenTreeTableProps } from '@lib/types/Tables';\nimport { ActionDropdown } from '../../components/items/ActionDropdown';\nimport OrderPartsWizard from '../../components/wizards/OrderPartsWizard';\nimport { formatDecimal, formatPriceRange } from '../../defaults/formatters';\nimport { usePartFields } from '../../forms/PartForms';\nimport { InvenTreeIcon } from '../../functions/icons';\nimport {\n  useBulkEditApiFormModal,\n  useCreateApiFormModal,\n  useEditApiFormModal\n} from '../../hooks/UseForm';\nimport { useTable } from '../../hooks/UseTable';\nimport { useUserState } from '../../states/UserState';\nimport {\n  CategoryColumn,\n  DefaultLocationColumn,\n  DescriptionColumn,\n  LinkColumn,\n  PartColumn\n} from '../ColumnRenderers';\nimport { InvenTreeTable } from '../InvenTreeTable';\nimport { TableHoverCard } from '../TableHoverCard';\n\n/**\n * Construct a list of columns for the part table\n */\nfunction partTableColumns(): TableColumn[] {\n  return [\n    {\n      accessor: 'name',\n      title: t`Part`,\n      sortable: true,\n      noWrap: true,\n      switchable: false,\n      render: (record: any) => PartColumn({ part: record })\n    },\n    {\n      accessor: 'IPN',\n      sortable: true\n    },\n    {\n      accessor: 'revision',\n      sortable: true\n    },\n    {\n      accessor: 'units',\n      sortable: true\n    },\n    DescriptionColumn({}),\n    CategoryColumn({\n      accessor: 'category_detail'\n    }),\n    DefaultLocationColumn({\n      accessor: 'default_location_detail'\n    }),\n    {\n      accessor: 'total_in_stock',\n      sortable: true,\n\n      render: (record) => {\n        const extra: ReactNode[] = [];\n\n        const stock = record?.total_in_stock ?? 0;\n        const allocated =\n          (record?.allocated_to_build_orders ?? 0) +\n          (record?.allocated_to_sales_orders ?? 0);\n        const available = Math.max(0, stock - allocated);\n        const min_stock = record?.minimum_stock ?? 0;\n\n        let text = String(formatDecimal(stock));\n\n        let color: string | undefined = undefined;\n\n        if (min_stock > stock) {\n          extra.push(\n            <Text key='min-stock' c='orange'>\n              {`${t`Minimum stock`}: ${formatDecimal(min_stock)}`}\n            </Text>\n          );\n\n          color = 'orange';\n        }\n\n        if (record.ordering > 0) {\n          extra.push(\n            <Text key='on-order'>{`${t`On Order`}: ${formatDecimal(record.ordering)}`}</Text>\n          );\n        }\n\n        if (record.building) {\n          extra.push(\n            <Text key='building'>{`${t`Building`}: ${formatDecimal(record.building)}`}</Text>\n          );\n        }\n\n        if (record.allocated_to_build_orders > 0) {\n          extra.push(\n            <Text key='bo-allocations'>\n              {`${t`Build Order Allocations`}: ${formatDecimal(record.allocated_to_build_orders)}`}\n            </Text>\n          );\n        }\n\n        if (record.allocated_to_sales_orders > 0) {\n          extra.push(\n            <Text key='so-allocations'>\n              {`${t`Sales Order Allocations`}: ${formatDecimal(record.allocated_to_sales_orders)}`}\n            </Text>\n          );\n        }\n\n        if (available != stock) {\n          extra.push(\n            <Text key='available'>\n              {t`Available`}: {formatDecimal(available)}\n            </Text>\n          );\n        }\n\n        if (record.external_stock > 0) {\n          extra.push(\n            <Text key='external'>\n              {t`External stock`}: {formatDecimal(record.external_stock)}\n            </Text>\n          );\n        }\n\n        if (stock <= 0) {\n          color = 'red';\n          text = t`No stock`;\n        } else if (available <= 0) {\n          color = 'orange';\n        } else if (available < min_stock) {\n          color = 'yellow';\n        }\n\n        return (\n          <TableHoverCard\n            value={\n              <Group gap='xs' justify='left' wrap='nowrap'>\n                <Text c={color}>{text}</Text>\n                {record.units && (\n                  <Text size='xs' c={color}>\n                    [{record.units}]\n                  </Text>\n                )}\n              </Group>\n            }\n            title={t`Stock Information`}\n            extra={extra}\n          />\n        );\n      }\n    },\n    {\n      accessor: 'price_range',\n      title: t`Price Range`,\n      sortable: true,\n      ordering: 'pricing_max',\n      defaultVisible: false,\n      render: (record: any) =>\n        formatPriceRange(record.pricing_min, record.pricing_max)\n    },\n    LinkColumn({})\n  ];\n}\n\n/**\n * Construct a set of filters for the part table\n */\nfunction partTableFilters(): TableFilter[] {\n  return [\n    {\n      name: 'active',\n      label: t`Active`,\n      description: t`Filter by part active status`,\n      type: 'boolean'\n    },\n    {\n      name: 'locked',\n      label: t`Locked`,\n      description: t`Filter by part locked status`,\n      type: 'boolean'\n    },\n    {\n      name: 'assembly',\n      label: t`Assembly`,\n      description: t`Filter by assembly attribute`,\n      type: 'boolean'\n    },\n    {\n      name: 'bom_valid',\n      label: t`BOM Valid`,\n      description: t`Filter by parts with a valid BOM`,\n      type: 'boolean'\n    },\n    {\n      name: 'cascade',\n      label: t`Include Subcategories`,\n      description: t`Include parts in subcategories`,\n      type: 'boolean'\n    },\n    {\n      name: 'component',\n      label: t`Component`,\n      description: t`Filter by component attribute`,\n      type: 'boolean'\n    },\n    {\n      name: 'testable',\n      label: t`Testable`,\n      description: t`Filter by testable attribute`,\n      type: 'boolean'\n    },\n    {\n      name: 'trackable',\n      label: t`Trackable`,\n      description: t`Filter by trackable attribute`,\n      type: 'boolean'\n    },\n    {\n      name: 'has_units',\n      label: t`Has Units`,\n      description: t`Filter by parts which have units`,\n      type: 'boolean'\n    },\n    {\n      name: 'has_ipn',\n      label: t`Has IPN`,\n      description: t`Filter by parts which have an internal part number`,\n      type: 'boolean'\n    },\n    {\n      name: 'has_stock',\n      label: t`Has Stock`,\n      description: t`Filter by parts which have stock`,\n      type: 'boolean'\n    },\n    {\n      name: 'low_stock',\n      label: t`Low Stock`,\n      description: t`Filter by parts which have low stock`,\n      type: 'boolean'\n    },\n    {\n      name: 'purchaseable',\n      label: t`Purchaseable`,\n      description: t`Filter by parts which are purchaseable`,\n      type: 'boolean'\n    },\n    {\n      name: 'salable',\n      label: t`Salable`,\n      description: t`Filter by parts which are salable`,\n      type: 'boolean'\n    },\n    {\n      name: 'virtual',\n      label: t`Virtual`,\n      description: t`Filter by parts which are virtual`,\n      type: 'choice',\n      choices: [\n        { value: 'true', label: t`Virtual` },\n        { value: 'false', label: t`Not Virtual` }\n      ]\n    },\n    {\n      name: 'is_template',\n      label: t`Is Template`,\n      description: t`Filter by parts which are templates`,\n      type: 'boolean'\n    },\n    {\n      name: 'is_variant',\n      label: t`Is Variant`,\n      description: t`Filter by parts which are variants`,\n      type: 'boolean'\n    },\n    {\n      name: 'is_revision',\n      label: t`Is Revision`,\n      description: t`Filter by parts which are revisions`\n    },\n    {\n      name: 'has_revisions',\n      label: t`Has Revisions`,\n      description: t`Filter by parts which have revisions`\n    },\n    {\n      name: 'has_pricing',\n      label: t`Has Pricing`,\n      description: t`Filter by parts which have pricing information`,\n      type: 'boolean'\n    },\n    {\n      name: 'unallocated_stock',\n      label: t`Available Stock`,\n      description: t`Filter by parts which have available stock`,\n      type: 'boolean'\n    },\n    {\n      name: 'starred',\n      label: t`Subscribed`,\n      description: t`Filter by parts to which the user is subscribed`,\n      type: 'boolean'\n    }\n  ];\n}\n\n/**\n * PartListTable - Displays a list of parts, based on the provided parameters\n * @param {Object} params - The query parameters to pass to the API\n * @returns\n */\nexport function PartListTable({\n  props,\n  defaultPartData\n}: Readonly<{\n  props: InvenTreeTableProps;\n  defaultPartData?: any;\n}>) {\n  const tableColumns = useMemo(() => partTableColumns(), []);\n  const tableFilters = useMemo(() => partTableFilters(), []);\n\n  const table = useTable('part-list');\n  const user = useUserState();\n\n  const initialPartData = useMemo(() => {\n    return defaultPartData ?? props.params ?? {};\n  }, [defaultPartData, props.params]);\n\n  const newPart = useCreateApiFormModal({\n    url: ApiEndpoints.part_list,\n    title: t`Add Part`,\n    fields: usePartFields({ create: true }),\n    initialData: initialPartData,\n    follow: true,\n    modelType: ModelType.part\n  });\n\n  const [selectedPart, setSelectedPart] = useState<number>(-1);\n\n  const editPart = useEditApiFormModal({\n    url: ApiEndpoints.part_list,\n    pk: selectedPart,\n    title: t`Edit Part`,\n    fields: usePartFields({ create: false }),\n    onFormSuccess: table.refreshTable\n  });\n\n  const setCategory = useBulkEditApiFormModal({\n    url: ApiEndpoints.part_list,\n    items: table.selectedIds,\n    title: t`Set Category`,\n    fields: {\n      category: {}\n    },\n    onFormSuccess: table.refreshTable\n  });\n\n  const orderPartsWizard = OrderPartsWizard({ parts: table.selectedRecords });\n\n  const rowActions = useCallback(\n    (record: any): RowAction[] => {\n      const can_edit = user.hasChangePermission(ModelType.part);\n\n      return [\n        RowEditAction({\n          hidden: !can_edit,\n          onClick: () => {\n            setSelectedPart(record.pk);\n            editPart.open();\n          }\n        })\n      ];\n    },\n    [user, editPart]\n  );\n\n  const tableActions = useMemo(() => {\n    return [\n      <ActionDropdown\n        tooltip={t`Part Actions`}\n        icon={<InvenTreeIcon icon='part' />}\n        disabled={!table.hasSelectedRecords}\n        actions={[\n          {\n            name: t`Set Category`,\n            icon: <InvenTreeIcon icon='category' />,\n            tooltip: t`Set category for selected parts`,\n            hidden: !user.hasChangeRole(UserRoles.part),\n            disabled: !table.hasSelectedRecords,\n            onClick: () => {\n              setCategory.open();\n            }\n          },\n          {\n            name: t`Order Parts`,\n            icon: <IconShoppingCart color='blue' />,\n            tooltip: t`Order selected parts`,\n            hidden: !user.hasAddRole(UserRoles.purchase_order),\n            onClick: () => {\n              orderPartsWizard.openWizard();\n            }\n          }\n        ]}\n      />,\n      <AddItemButton\n        key='add-part'\n        hidden={!user.hasAddRole(UserRoles.part)}\n        tooltip={t`Add Part`}\n        onClick={() => newPart.open()}\n      />\n    ];\n  }, [user, table.hasSelectedRecords]);\n\n  return (\n    <>\n      {newPart.modal}\n      {editPart.modal}\n      {setCategory.modal}\n      {orderPartsWizard.wizard}\n      <InvenTreeTable\n        url={apiUrl(ApiEndpoints.part_list)}\n        tableState={table}\n        columns={tableColumns}\n        props={{\n          ...props,\n          enableDownload: true,\n          modelType: ModelType.part,\n          tableFilters: tableFilters,\n          tableActions: tableActions,\n          rowActions: rowActions,\n          enableSelection: true,\n          enableReports: true,\n          enableLabels: true,\n          params: {\n            ...props.params,\n            category_detail: true,\n            location_detail: true\n          }\n        }}\n      />\n    </>\n  );\n}\n"],"names":["usePartFields","create","settings","useGlobalSettingsState","useMemo","fields","category","filters","structural","name","IPN","description","revision","revision_of","is_revision","is_template","variant_of","keywords","units","link","default_location","default_expiry","minimum_stock","responsible","is_active","component","assembly","testable","trackable","purchaseable","salable","virtual","locked","active","starred","field_type","label","_i18n","_","id","disabled","required","copy_category_parameters","initial_stock","icon","IconPackages","children","quantity","value","location","initial_supplier","supplier","is_supplier","sku","manufacturer","is_manufacturer","mpn","isSet","partCategoryFields","parent","default_keywords","usePartParameterFields","editTemplate","api","useApi","choices","setChoices","useState","fieldType","setFieldType","part","template","onValueChange","record","checkbox","_choices","split","length","map","choice","display_name","trim","selectionlist","get","apiUrl","ApiEndpoints","selectionlist_detail","then","res","data","item","type","undefined","default","adjustValue","v","toString","toLowerCase","note","partStocktakeFields","hidden","item_count","cost_min","cost_min_currency","cost_max","cost_max_currency","partTableColumns","accessor","title","sortable","noWrap","switchable","render","PartColumn","DescriptionColumn","CategoryColumn","DefaultLocationColumn","extra","stock","total_in_stock","allocated","allocated_to_build_orders","allocated_to_sales_orders","available","Math","max","min_stock","text","String","formatDecimal","color","push","jsx","Text","ordering","building","external_stock","TableHoverCard","jsxs","Group","defaultVisible","formatPriceRange","pricing_min","pricing_max","LinkColumn","partTableFilters","PartListTable","props","defaultPartData","tableColumns","tableFilters","table","useTable","user","useUserState","initialPartData","params","newPart","useCreateApiFormModal","url","part_list","initialData","follow","modelType","ModelType","selectedPart","setSelectedPart","editPart","useEditApiFormModal","pk","onFormSuccess","refreshTable","setCategory","useBulkEditApiFormModal","items","selectedIds","orderPartsWizard","OrderPartsWizard","parts","selectedRecords","rowActions","useCallback","can_edit","hasChangePermission","RowEditAction","onClick","open","tableActions","ActionDropdown","InvenTreeIcon","hasSelectedRecords","tooltip","hasChangeRole","UserRoles","IconShoppingCart","hasAddRole","purchase_order","openWizard","AddItemButton","modal","wizard","InvenTreeTable","enableDownload","enableSelection","enableReports","enableLabels","category_detail","location_detail"],"mappings":"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"}
