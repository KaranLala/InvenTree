{"version":3,"file":"CompanyTable-DAUnvNdt.js","sources":["../../../../../../frontend/src/tables/company/CompanyTable.tsx"],"sourcesContent":["import { t } from '@lingui/core/macro';\nimport { useCallback, useMemo, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\n\nimport { AddItemButton } from '@lib/components/AddItemButton';\nimport { type RowAction, RowEditAction } from '@lib/components/RowActions';\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { ModelType } from '@lib/enums/ModelType';\nimport { UserRoles } from '@lib/enums/Roles';\nimport { apiUrl } from '@lib/functions/Api';\nimport { navigateToLink } from '@lib/functions/Navigation';\nimport type { TableFilter } from '@lib/types/Filters';\nimport { companyFields } from '../../forms/CompanyForms';\nimport {\n  useCreateApiFormModal,\n  useEditApiFormModal\n} from '../../hooks/UseForm';\nimport { useTable } from '../../hooks/UseTable';\nimport { useUserState } from '../../states/UserState';\nimport {\n  BooleanColumn,\n  CompanyColumn,\n  DescriptionColumn\n} from '../ColumnRenderers';\nimport { InvenTreeTable } from '../InvenTreeTable';\n\n/**\n * A table which displays a list of company records,\n * based on the provided filter parameters\n */\nexport function CompanyTable({\n  params,\n  path\n}: Readonly<{\n  params?: any;\n  path?: string;\n}>) {\n  const table = useTable('company');\n\n  const navigate = useNavigate();\n  const user = useUserState();\n\n  const columns = useMemo(() => {\n    return [\n      {\n        accessor: 'name',\n        sortable: true,\n        switchable: false,\n        render: (record: any) => {\n          return <CompanyColumn company={record} />;\n        }\n      },\n      DescriptionColumn({}),\n      BooleanColumn({\n        accessor: 'active',\n        title: t`Active`,\n        sortable: true,\n        switchable: true\n      }),\n      {\n        accessor: 'website',\n        sortable: false\n      }\n    ];\n  }, []);\n\n  const newCompany = useCreateApiFormModal({\n    url: ApiEndpoints.company_list,\n    title: t`Add Company`,\n    fields: companyFields(),\n    initialData: params,\n    follow: true,\n    modelType: ModelType.company\n  });\n\n  const [selectedCompany, setSelectedCompany] = useState<number>(0);\n\n  const editCompany = useEditApiFormModal({\n    url: ApiEndpoints.company_list,\n    pk: selectedCompany,\n    title: t`Edit Company`,\n    fields: companyFields(),\n    onFormSuccess: (record: any) => table.updateRecord(record)\n  });\n\n  const tableFilters: TableFilter[] = useMemo(() => {\n    return [\n      {\n        name: 'active',\n        label: t`Active`,\n        description: t`Show active companies`\n      },\n      {\n        name: 'is_supplier',\n        label: t`Supplier`,\n        description: t`Show companies which are suppliers`\n      },\n      {\n        name: 'is_manufacturer',\n        label: t`Manufacturer`,\n        description: t`Show companies which are manufacturers`\n      },\n      {\n        name: 'is_customer',\n        label: t`Customer`,\n        description: t`Show companies which are customers`\n      }\n    ];\n  }, []);\n\n  const tableActions = useMemo(() => {\n    const can_add =\n      user.hasAddRole(UserRoles.purchase_order) ||\n      user.hasAddRole(UserRoles.sales_order);\n\n    return [\n      <AddItemButton\n        key='add-company'\n        tooltip={t`Add Company`}\n        onClick={() => newCompany.open()}\n        hidden={!can_add}\n      />\n    ];\n  }, [user]);\n\n  const rowActions = useCallback(\n    (record: any): RowAction[] => {\n      return [\n        RowEditAction({\n          hidden:\n            !user.hasChangeRole(UserRoles.purchase_order) &&\n            !user.hasChangeRole(UserRoles.sales_order),\n          onClick: () => {\n            setSelectedCompany(record.pk);\n            editCompany.open();\n          }\n        })\n      ];\n    },\n    [user]\n  );\n\n  return (\n    <>\n      {newCompany.modal}\n      {editCompany.modal}\n      <InvenTreeTable\n        url={apiUrl(ApiEndpoints.company_list)}\n        tableState={table}\n        columns={columns}\n        props={{\n          params: {\n            ...params\n          },\n          onRowClick: (record: any, index: number, event: any) => {\n            if (record.pk) {\n              const base = path ?? 'company';\n              navigateToLink(`/${base}/${record.pk}`, navigate, event);\n            }\n          },\n          modelType: ModelType.company,\n          tableFilters: tableFilters,\n          tableActions: tableActions,\n          enableDownload: true,\n          enableSelection: true,\n          enableReports: true,\n          rowActions: rowActions\n        }}\n      />\n    </>\n  );\n}\n"],"names":["CompanyTable","params","path","table","useTable","navigate","useNavigate","user","useUserState","columns","useMemo","accessor","sortable","switchable","render","record","jsx","CompanyColumn","DescriptionColumn","BooleanColumn","title","_i18n","_","id","newCompany","useCreateApiFormModal","url","ApiEndpoints","company_list","fields","companyFields","initialData","follow","modelType","ModelType","company","selectedCompany","setSelectedCompany","useState","editCompany","useEditApiFormModal","pk","onFormSuccess","updateRecord","tableFilters","name","label","description","tableActions","can_add","hasAddRole","UserRoles","purchase_order","sales_order","AddItemButton","open","rowActions","useCallback","RowEditAction","hidden","hasChangeRole","onClick","modal","InvenTreeTable","apiUrl","onRowClick","index","event","navigateToLink","enableDownload","enableSelection","enableReports"],"mappings":"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"}
