{"version":3,"file":"ManufacturerPartTable-D4WNHrha.js","sources":["../../../../../../frontend/src/tables/purchasing/ManufacturerPartTable.tsx"],"sourcesContent":["import { t } from '@lingui/core/macro';\nimport { type ReactNode, useCallback, useMemo, useState } from 'react';\n\nimport { AddItemButton } from '@lib/components/AddItemButton';\nimport {\n  type RowAction,\n  RowDeleteAction,\n  RowEditAction\n} from '@lib/components/RowActions';\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { ModelType } from '@lib/enums/ModelType';\nimport { UserRoles } from '@lib/enums/Roles';\nimport { apiUrl } from '@lib/functions/Api';\nimport type { TableColumn } from '@lib/types/Tables';\nimport { useManufacturerPartFields } from '../../forms/CompanyForms';\nimport {\n  useCreateApiFormModal,\n  useDeleteApiFormModal,\n  useEditApiFormModal\n} from '../../hooks/UseForm';\nimport { useTable } from '../../hooks/UseTable';\nimport { useUserState } from '../../states/UserState';\nimport {\n  CompanyColumn,\n  DescriptionColumn,\n  LinkColumn,\n  PartColumn\n} from '../ColumnRenderers';\nimport { InvenTreeTable } from '../InvenTreeTable';\n\n/*\n * Construct a table listing manufacturer parts\n */\nexport function ManufacturerPartTable({\n  params\n}: Readonly<{ params: any }>): ReactNode {\n  const table = useTable('manufacturerparts');\n\n  const user = useUserState();\n\n  // Construct table columns for this table\n  const tableColumns: TableColumn[] = useMemo(() => {\n    return [\n      {\n        accessor: 'part',\n        switchable: 'part' in params,\n        sortable: true,\n        render: (record: any) => PartColumn({ part: record?.part_detail })\n      },\n      {\n        accessor: 'manufacturer',\n        sortable: true,\n        render: (record: any) => (\n          <CompanyColumn company={record?.manufacturer_detail} />\n        )\n      },\n      {\n        accessor: 'MPN',\n        title: t`Manufacturer Part Number`,\n        sortable: true\n      },\n      DescriptionColumn({}),\n      LinkColumn({})\n    ];\n  }, [params]);\n\n  const manufacturerPartFields = useManufacturerPartFields();\n\n  const [selectedPart, setSelectedPart] = useState<number | undefined>(\n    undefined\n  );\n\n  const createManufacturerPart = useCreateApiFormModal({\n    url: ApiEndpoints.manufacturer_part_list,\n    title: t`Add Manufacturer Part`,\n    fields: manufacturerPartFields,\n    table: table,\n    initialData: {\n      manufacturer: params?.manufacturer,\n      part: params?.part\n    }\n  });\n\n  const editManufacturerPart = useEditApiFormModal({\n    url: ApiEndpoints.manufacturer_part_list,\n    pk: selectedPart,\n    title: t`Edit Manufacturer Part`,\n    fields: manufacturerPartFields,\n    table: table\n  });\n\n  const deleteManufacturerPart = useDeleteApiFormModal({\n    url: ApiEndpoints.manufacturer_part_list,\n    pk: selectedPart,\n    title: t`Delete Manufacturer Part`,\n    table: table\n  });\n\n  const tableActions = useMemo(() => {\n    const can_add =\n      user.hasAddRole(UserRoles.purchase_order) &&\n      user.hasAddRole(UserRoles.part);\n\n    return [\n      <AddItemButton\n        key='add-manufacturer-part'\n        tooltip={t`Add Manufacturer Part`}\n        onClick={() => createManufacturerPart.open()}\n        hidden={!can_add}\n      />\n    ];\n  }, [user]);\n\n  const rowActions = useCallback(\n    (record: any): RowAction[] => {\n      return [\n        RowEditAction({\n          hidden: !user.hasChangeRole(UserRoles.purchase_order),\n          onClick: () => {\n            setSelectedPart(record.pk);\n            editManufacturerPart.open();\n          }\n        }),\n        RowDeleteAction({\n          hidden: !user.hasDeleteRole(UserRoles.purchase_order),\n          onClick: () => {\n            setSelectedPart(record.pk);\n            deleteManufacturerPart.open();\n          }\n        })\n      ];\n    },\n    [user]\n  );\n\n  return (\n    <>\n      {createManufacturerPart.modal}\n      {editManufacturerPart.modal}\n      {deleteManufacturerPart.modal}\n      <InvenTreeTable\n        url={apiUrl(ApiEndpoints.manufacturer_part_list)}\n        tableState={table}\n        columns={tableColumns}\n        props={{\n          params: {\n            ...params,\n            part_detail: true,\n            manufacturer_detail: true\n          },\n          enableDownload: true,\n          rowActions: rowActions,\n          tableActions: tableActions,\n          modelType: ModelType.manufacturerpart\n        }}\n      />\n    </>\n  );\n}\n"],"names":["ManufacturerPartTable","params","table","useTable","user","useUserState","tableColumns","useMemo","accessor","switchable","sortable","render","record","PartColumn","part","part_detail","CompanyColumn","manufacturer_detail","title","_i18n","_","id","DescriptionColumn","LinkColumn","manufacturerPartFields","useManufacturerPartFields","selectedPart","setSelectedPart","useState","undefined","createManufacturerPart","useCreateApiFormModal","url","ApiEndpoints","manufacturer_part_list","fields","initialData","manufacturer","editManufacturerPart","useEditApiFormModal","pk","deleteManufacturerPart","useDeleteApiFormModal","tableActions","can_add","hasAddRole","UserRoles","purchase_order","jsx","AddItemButton","open","rowActions","useCallback","RowEditAction","hidden","hasChangeRole","onClick","RowDeleteAction","hasDeleteRole","modal","InvenTreeTable","apiUrl","enableDownload","modelType","ModelType","manufacturerpart"],"mappings":"sXAiCO,SAASA,EAAsB,CACpCC,OAAAA,CACyB,EAAc,CACjCC,MAAAA,EAAQC,EAAS,mBAAmB,EAEpCC,EAAOC,EAAa,EAGpBC,EAA8BC,EAAAA,QAAQ,IACnC,CACL,CACEC,SAAU,OACVC,WAAY,SAAUR,EACtBS,SAAU,GACVC,OAASC,GAAgBC,EAAW,CAAEC,KAAMF,GAAAA,YAAAA,EAAQG,WAAa,CAAA,CAAA,EAEnE,CACEP,SAAU,eACVE,SAAU,GACVC,OAASC,SACNI,EAAc,CAAA,QAASJ,GAAAA,YAAAA,EAAQK,mBAAoB,CAAA,CAAA,EAGxD,CACET,SAAU,MACVU,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAA2B,EAClCX,SAAU,EACZ,EACAY,EAAkB,CAAE,CAAA,EACpBC,EAAW,CAAE,CAAA,CAAC,EAEf,CAACtB,CAAM,CAAC,EAELuB,EAAyBC,EAA0B,EAEnD,CAACC,EAAcC,CAAe,EAAIC,EAAAA,SACtCC,MACF,EAEMC,EAAyBC,EAAsB,CACnDC,IAAKC,EAAaC,uBAClBhB,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAAwB,EAC/Bc,OAAQX,EACRtB,MAAAA,EACAkC,YAAa,CACXC,aAAcpC,GAAAA,YAAAA,EAAQoC,aACtBvB,KAAMb,GAAAA,YAAAA,EAAQa,IAAAA,CAChB,CACD,EAEKwB,EAAuBC,EAAoB,CAC/CP,IAAKC,EAAaC,uBAClBM,GAAId,EACJR,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAAyB,EAChCc,OAAQX,EACRtB,MAAAA,CAAAA,CACD,EAEKuC,EAAyBC,EAAsB,CACnDV,IAAKC,EAAaC,uBAClBM,GAAId,EACJR,MAAKC,EAAAC,EAAE,CAAAC,GAAA,QAAA,CAA2B,EAClCnB,MAAAA,CAAAA,CACD,EAEKyC,EAAepC,EAAAA,QAAQ,IAAM,CAC3BqC,MAAAA,EACJxC,EAAKyC,WAAWC,EAAUC,cAAc,GACxC3C,EAAKyC,WAAWC,EAAUhC,IAAI,EAEhC,MAAO,CACLkC,EAAAA,IAACC,EAEC,CAAA,QAAQ9B,EAAAC,EAAC,CAAAC,GAAA,QAAA,CAAuB,EAChC,QAAS,IAAMS,EAAuBoB,KAAAA,EACtC,OAAQ,CAACN,GAHL,wBAIJ,CAAA,EAEH,CAACxC,CAAI,CAAC,EAEH+C,EAAaC,cAChBxC,GACQ,CACLyC,EAAc,CACZC,OAAQ,CAAClD,EAAKmD,cAAcT,EAAUC,cAAc,EACpDS,QAASA,IAAM,CACb7B,EAAgBf,EAAO4B,EAAE,EACzBF,EAAqBY,KAAK,CAAA,CAE7B,CAAA,EACDO,EAAgB,CACdH,OAAQ,CAAClD,EAAKsD,cAAcZ,EAAUC,cAAc,EACpDS,QAASA,IAAM,CACb7B,EAAgBf,EAAO4B,EAAE,EACzBC,EAAuBS,KAAK,CAAA,CAC9B,CACD,CAAC,EAGN,CAAC9C,CAAI,CACP,EAEA,OAEK0B,EAAAA,KAAAA,WAAAA,CAAAA,SAAAA,CAAuB6B,EAAAA,MACvBrB,EAAqBqB,MACrBlB,EAAuBkB,MACxBX,EAAAA,IAACY,EACC,CAAA,IAAKC,EAAO5B,EAAaC,sBAAsB,EAC/C,WAAYhC,EACZ,QAASI,EACT,MAAO,CACLL,OAAQ,CACN,GAAGA,EACHc,YAAa,GACbE,oBAAqB,EACvB,EACA6C,eAAgB,GAChBX,WAAAA,EACAR,aAAAA,EACAoB,UAAWC,EAAUC,gBAAAA,CACrB,CAAA,CAAA,EAEN,CAEJ"}
