import{r as p,i as e,j as s,B as l,G as E}from"./vendor-c9tu_e1b.js";import{A as w}from"./ActionButton-Cn3lAMG1.js";import{b as L,A as V,g as j,n as C}from"./UseForm-21BEg7Md.js";import{b as M,f as T,m as b,A as S,U as y,e as U,h as D}from"./index-C-YqHYR0.js";import{O as B}from"./OrderPartsWizard-DcOlnycT.js";import{a as N,b as q}from"./formatters-1-K9MQML.js";import{u as G,a as O}from"./UseStockAdjustActions-PDcplZpx.js";import{a as H,I as X}from"./ThemeContext-CVPHi9Q7.js";import{u as J,I as K,o as Q,n as W,p as Y,q as Z,r as $,B as ee,s as te,t as se,v as ie,w as ae}from"./InvenTreeTable-_nPJoCLK.js";import{P as le,D as re,S as oe,j as de,k as h}from"./ColumnRenderers-6-W27ey5.js";function ne({showLocation:r,showPricing:_}){return[{accessor:"part",sortable:!0,render:t=>le({part:t==null?void 0:t.part_detail})},{accessor:"part_detail.IPN",title:e._({id:"3wXEsN"}),sortable:!0},{accessor:"part_detail.revision",title:e._({id:"6LTyxl"}),sortable:!0,defaultVisible:!1},re({accessor:"part_detail.description"}),{accessor:"quantity",ordering:"stock",sortable:!0,title:e._({id:"blbbPS"}),render:t=>{const o=(t==null?void 0:t.quantity)??0,c=(t==null?void 0:t.allocated)??0,u=o-c;let a=j(o);const d=(t==null?void 0:t.part_detail)??{},i=[];let n;return t.serial&&o==1&&(a=`# ${t.serial}`),t.is_building?(n="blue",i.push(s.jsx(l,{size:"sm",children:e._({id:"fh2Vf5"})},"production"))):t.sales_order?i.push(s.jsx(l,{size:"sm",children:e._({id:"X1BIR/"})},"sales-order")):t.customer?i.push(s.jsx(l,{size:"sm",children:e._({id:"fHlvYo"})},"customer")):t.belongs_to?i.push(s.jsx(l,{size:"sm",children:e._({id:"bGwMIh"})},"belongs-to")):t.consumed_by?i.push(s.jsx(l,{size:"sm",children:e._({id:"Xig/cj"})},"consumed-by")):t.in_stock||i.push(s.jsx(l,{size:"sm",children:e._({id:"szsXHP"})},"unavailable")),t.expired?i.push(s.jsx(l,{size:"sm",children:e._({id:"x/QIhZ"})},"expired")):t.stale&&i.push(s.jsx(l,{size:"sm",children:e._({id:"UtuqjX"})},"stale")),t.in_stock&&(c>0&&(c>=o?(n="orange",i.push(s.jsx(l,{size:"sm",children:e._({id:"L1D5PL"})},"fully-allocated"))):i.push(s.jsx(l,{size:"sm",children:e._({id:"PjVOCj"})},"partially-allocated"))),u!=o&&(u>0?i.push(s.jsx(l,{size:"sm",c:"orange",children:`${e._({id:"csDS2L"})}: ${j(u)}`},"available")):i.push(s.jsx(l,{size:"sm",c:"red",children:e._({id:"a5n/wL"})},"no-stock"))),o<=0&&i.push(s.jsx(l,{size:"sm",children:e._({id:"ddPzUj"})},"depleted"))),t.in_stock||(n="red"),s.jsx(C,{value:s.jsxs(E,{gap:"xs",justify:"left",wrap:"nowrap",children:[s.jsx(l,{c:n,children:a}),d.units&&s.jsxs(l,{size:"xs",c:n,children:["[",d.units,"]"]})]}),title:e._({id:"odasNw"}),extra:i})}},oe({model:b.stockitem}),{accessor:"batch",sortable:!0},de({hidden:!r,accessor:"location_detail"}),{accessor:"purchase_order",title:e._({id:"KxySMG"}),defaultVisible:!1,render:t=>t.purchase_order_reference},{accessor:"SKU",title:e._({id:"nne72x"}),sortable:!0,defaultVisible:!1},{accessor:"MPN",title:e._({id:"bisS0I"}),sortable:!0,defaultVisible:!1},{accessor:"purchase_price",title:e._({id:"vWelsN"}),sortable:!0,switchable:!0,hidden:!_,defaultVisible:!1,render:t=>N(t.purchase_price,{currency:t.purchase_price_currency})},{accessor:"stock_value",title:e._({id:"g9RfVq"}),sortable:!1,hidden:!_,render:t=>{var a,d;const o=t.purchase_price||((a=t.part_detail)==null?void 0:a.pricing_min),c=t.purchase_price||((d=t.part_detail)==null?void 0:d.pricing_max),u=t.purchase_price_currency||void 0;return q(o,c,{currency:u,multiplier:t.quantity})}},{accessor:"packaging",sortable:!0,defaultVisible:!1},h({title:e._({id:"uaSvqt"}),accessor:"expiry_date",hidden:!T.getState().isSet("STOCK_ENABLE_EXPIRY"),defaultVisible:!1}),h({title:e._({id:"K7P0jz"}),accessor:"updated"}),h({accessor:"stocktake_date",title:e._({id:"6OScNP"}),sortable:!0})]}function ce({enableExpiry:r}){return[{name:"active",label:e._({id:"F6pfE9"}),description:e._({id:"UjHL/d"})},{name:"status",label:e._({id:"uAQUqI"}),description:e._({id:"+Jr1e4"}),choiceFunction:Q(b.stockitem)},{name:"assembly",label:e._({id:"WL36Yh"}),description:e._({id:"3Ah+L7"})},{name:"allocated",label:e._({id:"A/ybx7"}),description:e._({id:"pxiNcZ"})},{name:"available",label:e._({id:"csDS2L"}),description:e._({id:"kbUAFH"})},{name:"cascade",label:e._({id:"VY386J"}),description:e._({id:"fMbOmV"})},{name:"depleted",label:e._({id:"9/P0N3"}),description:e._({id:"0n9TfP"})},{name:"in_stock",label:e._({id:"zn38D/"}),description:e._({id:"oXdFGe"})},{name:"is_building",label:e._({id:"BE5Q6v"}),description:e._({id:"c64azd"})},W(),Y(),Z(),{name:"consumed",label:e._({id:"XNITBt"}),description:e._({id:"1yWWZV"})},{name:"installed",label:e._({id:"eQkgKV"}),description:e._({id:"GQ73kf"})},{name:"sent_to_customer",label:e._({id:"XwjZor"}),description:e._({id:"LPuYfz"})},$(),ee(),te(),se(),ie(),ae(),{name:"tracked",label:e._({id:"EaG6cP"}),description:e._({id:"TRFyJq"})},{name:"has_purchase_price",label:e._({id:"+MprDT"}),description:e._({id:"tAFrkr"})},{name:"expired",label:e._({id:"M1RnFv"}),description:e._({id:"JiHUig"}),active:r},{name:"stale",label:e._({id:"1ba70W"}),description:e._({id:"SQjqoc"}),active:r},{name:"expiry_before",label:e._({id:"mHDi5V"}),description:e._({id:"j2+SIa"}),type:"date",active:r},{name:"expiry_after",label:e._({id:"snknx0"}),description:e._({id:"UyBcoZ"}),type:"date",active:r},{name:"updated_before",label:e._({id:"h8xl5M"}),description:e._({id:"5zwJta"}),type:"date"},{name:"updated_after",label:e._({id:"nl9mSR"}),description:e._({id:"P5Y0sz"}),type:"date"},{name:"stocktake_before",label:e._({id:"Hj/Grl"}),description:e._({id:"iTehcJ"}),type:"date"},{name:"stocktake_after",label:e._({id:"+GUu77"}),description:e._({id:"w30K80"}),type:"date"},{name:"external",label:e._({id:"k7rbV9"}),description:e._({id:"ETtRZU"})}]}function Se({params:r={},allowAdd:_=!1,showLocation:t=!0,showPricing:o=!0,allowReturn:c=!1,tableName:u="stockitems"}){const a=J(u),d=M(),i=T(),n=p.useMemo(()=>i.isSet("STOCK_ENABLE_EXPIRY"),[i]),z=H(),I=p.useMemo(()=>ne({showLocation:t??!0,showPricing:o??!0}),[t,o]),g=p.useMemo(()=>ce({enableExpiry:n}),[n]),v=p.useMemo(()=>({items:a.selectedRecords,model:b.stockitem,refresh:a.refreshTable,filters:{in_stock:!0}}),[a.selectedRecords,a.refreshTable]),F=G({create:!0,partId:r.part,modalId:"add-stock-item"}),k=L({url:S.stock_item_list,title:e._({id:"bJLEQT"}),modalId:"add-stock-item",fields:F,initialData:{part:r.part,location:r.location},follow:!0,table:a,onFormSuccess:m=>{z(D(b.stockitem,m[0].pk))},successMessage:e._({id:"Hkw/xj"})}),[P,A]=p.useState([]),x=B({parts:P}),f=O({formProps:v,return:c}),R=p.useMemo(()=>[f.dropdown,s.jsx(w,{hidden:!d.hasAddRole(y.purchase_order),tooltip:e._({id:"0TfxKY"}),icon:s.jsx(X,{icon:"buy"}),disabled:!a.hasSelectedRecords,onClick:()=>{A(a.selectedRecords.map(m=>m.part_detail)),x.openWizard()}},"stock-order"),s.jsx(V,{hidden:!_||!d.hasAddRole(y.stock),tooltip:e._({id:"bJLEQT"}),onClick:()=>k.open()},"add-stock-item")],[d,_,a.hasSelectedRecords,a.selectedRecords,f.dropdown]);return s.jsxs(s.Fragment,{children:[k.modal,x.wizard,f.modals.map(m=>m.modal),s.jsx(K,{url:U(S.stock_item_list),tableState:a,columns:I,props:{enableDownload:!0,enableSelection:!0,enableLabels:!0,enableReports:!0,tableFilters:g,tableActions:R,modelType:b.stockitem,params:{...r,part_detail:!0,location_detail:!0,supplier_part_detail:!0}}})]})}export{Se as S};
//# sourceMappingURL=StockItemTable-BNURu3dq.js.map
